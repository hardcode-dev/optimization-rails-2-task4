# Case-study задания

## Задание

Проверить гипотезу о том, что можно закешировать `<%= render "articles/single_story", story: story %>` в `_main_stories_feed.html.erb` и это даст заметный эффект.

## Выполнение

### Подготовка к выполнению

1. Настройка `local_production` environment.
   `local_production` -- Это environment, который работает точно так же как и продакшн.
2. `NewRelic`
   `NewRelic` помог исследовать поведение приложение с разных сторон
3. `Skylight`  
   Использовать так и не вышло. Вроде бы все натсроил, но почему то приложение так и не начало отправлять репорты.  
   Скорее всего это связано с тем, что приложение запускалось локально.
4. Настроил `rack-mini-profiler`
5. Настроил `rails-panel`

Остальные инструменты не было времени попробовать(Prometheus + Grafana и т.д.).
Обязательно попрактикую их как появится время и возможность.

### Проверка гипотезы

Для проверки гипотезы, я использовал:

- Результаты замера с помощью `Appache Benchmark`
- Показатели `Rails Panel`

Оба инструмента подтвердили теорию о том, что кэширование может сократить время рендеринга.  
Рузультатом стало то, что время рендеринга сократилось примерно в 3 раза

Поэтому было решено оставить данную оптимизацию.

Заметил, что у каждой "истории" есть свои лайки и коментарии. Для того что бы счетчики,
которые отображаются в закешированном шаблоне работали корректно добавил `touch: true` к их ассоциациям.
